/* --- Sidebar --- */
.sidebar {
  position: fixed;
  left: 0;
  top: 0;
  width: 72px;
  height: 100vh;
  background: #f7f7fa;
  border-right: 1px solid #e5e5ea;
  display: flex;
  flex-direction: column;
  align-items: center;
  z-index: 100;
  box-shadow: 1px 0 8px #0001;
}
.sidebar-inner {
  width: 100%;
  padding: 24px 0 0 0;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* --- Main Content --- */
.main-content {
  margin-left: 0;
  min-height: 100vh;
  background: var(--main-bg);
  display: flex;
  flex-direction: column;
  padding: 0 0 0 0;
  transition: background 0.35s;
}

/* --- Action Bar (шапка) --- */
#action-bar {
  width: 100%;
  background: #fff;
  box-shadow: 0 2px 8px #0001;
  border-bottom: 1px solid #e5e5ea;
  padding: 0;
  position: sticky;
  top: 0;
  z-index: 10;
}
.action-bar-inner {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 32px 12px 24px;
}
#action-bar button {
  background: #f7f7fa;
  border: 1px solid #e5e5ea;
  border-radius: 8px;
  color: #222;
  font-size: 1em;
  padding: 8px 18px;
  font-family: var(--font);
  font-weight: 500;
  cursor: pointer;
  transition: background 0.15s, border 0.15s;
}
#action-bar button:hover {
  background: #ececec;
  border-color: #d1d1d6;
}

/* --- Центрирование таблицы --- */
.table-center-wrap {
  display: flex;
  justify-content: center;
  align-items: flex-start;
  min-height: 60vh;
  padding: 32px 0 0 0;
}

/* --- Минималистичная таблица --- */
.minimal-table {
  background: #fff;
  border-radius: 18px;
  box-shadow: 0 2px 12px #0001;
  border-collapse: separate;
  border-spacing: 0;
  min-width: 520px;
  max-width: 100%;
  width: 100%;
  margin: 0 auto;
  font-size: 0.98em;
  color: #222;
  table-layout: fixed;
}
.minimal-table th, .minimal-table td {
  border-bottom: 1px solid #ececec;
  padding: 8px 10px;
  text-align: left;
  background: transparent;
  font-size: 1em;
  height: 36px;
}
.minimal-table th {
  font-weight: 600;
  color: #888;
  background: #fafbfc;
  border-bottom: 1.5px solid #e5e5ea;
  font-size: 0.97em;
  height: 38px;
}
.minimal-table tr:last-child td {
  border-bottom: none;
}
.minimal-table tr {
  transition: background 0.15s;
  height: 38px;
}
.minimal-table tr:hover {
  background: #f5f5f7;
}
.minimal-table td {
  border-right: none;
  border-left: none;
  border-top: none;
}
.minimal-table {
  border: none;
}

/* --- Убираем яркие цвета, только светлые и серые тона --- */
:root {
  --accent: #222;
  --main-bg: #fafbfc;
  --panel-bg: #fff;
  --border: #e5e5ea;
  --text: #222;
  --text-light: #888;
  --radius: 12px;
  --radius-sm: 8px;
  --shadow: 0 2px 12px #0001;
  --font: -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Arial,sans-serif;
}
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  background: var(--main-bg);
  color: var(--text);
  font-family: var(--font);
  font-size: 17px;
  transition: background 0.2s, color 0.2s;
}
#app {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  padding: 0 16px;
  background: var(--main-bg);
}
.table-wrapper {
  flex: 1 1 0;
  background: var(--panel-bg);
  border-radius: 22px;
  box-shadow: 0 4px 24px #0002;
  padding: 0 0 10px 0;
  margin-bottom: 28px;
  overflow-x: auto;
  transition: background 0.2s, box-shadow 0.2s;
  max-width: 100vw;
}
table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  background: transparent;
}
th, td {
  padding: 14px 18px;
  font-size: 1em;
  border-right: 1px solid var(--border);
  vertical-align: middle;
  background: transparent;
}
th:last-child, td:last-child {
  border-right: none;
}
th {
  font-weight: 600;
  color: var(--text-light);
  background: var(--main-bg);
  text-align: left;
  position: sticky;
  top: 0;
  z-index: 2;
  letter-spacing: 0.01em;
}
tbody tr {
  border-bottom: 1px solid var(--border);
  transition: background var(--transition);
}
tbody tr:nth-child(even) {
  background: #f2f2f7;
}
tbody tr:hover {
  background: #e5e5ea;
}
tbody tr[style*="background:#3a4252"] {
  background: #e0e7ff !important;
  font-weight: 600;
}
tr.active-turn {
  background: #e0e7ff !important;
  box-shadow: 0 2px 12px #007aff22;
  border-left: 4px solid #007aff;
  animation: none;
}
@keyframes activeRowPulse {
  from { box-shadow: 0 2px 12px #007aff11; }
  to { box-shadow: 0 4px 24px #007aff33; }
}
tr.drag-over {
  outline: 2px dashed #007aff;
  background: #e5f0ff !important;
}
tr.dragging {
  opacity: 0.5;
}
.col-num, .col-insp, .col-eff, .col-slots, .col-inv, .col-act {
  text-align: center;
  min-width: 44px;
}
.col-name {
  min-width: 120px;
  font-weight: 500;
}
.col-type, .col-init, .col-ac, .col-hp {
  min-width: 60px;
}
.table-wrapper table {
  border-radius: var(--radius);
  overflow: hidden;
}
button, .table-wrapper button {
  border-radius: 12px;
  background: #fff;
  color: #111;
  border: 1px solid #d1d1d6;
  padding: 10px 24px;
  font-size: 1em;
  font-family: var(--font);
  font-weight: 500;
  cursor: pointer;
  box-shadow: 0 1.5px 6px #0001;
  transition: background 0.18s, color 0.18s, box-shadow 0.18s, border 0.18s, transform 0.1s;
  outline: none;
  letter-spacing: 0.01em;
}
button:hover, .table-wrapper button:hover {
  background: #f5f5f7;
  color: #111;
  box-shadow: 0 4px 16px #0001;
  border-color: #bfc0c5;
}
button:active, .table-wrapper button:active {
  background: #ececec;
  color: #111;
  transform: scale(0.98);
  box-shadow: 0 1px 4px #0001;
}
input[type="text"], input[type="number"], select {
  background: #fff;
  border: 1px solid #d1d1d6;
  border-radius: 10px;
  padding: 10px 16px;
  font-size: 1em;
  font-family: var(--font);
  transition: border 0.18s, box-shadow 0.18s;
  outline: none;
  color: #111;
  box-shadow: 0 1px 4px #0001;
}
input[type="text"]:focus, input[type="number"]:focus, select:focus {
  border-color: #007aff;
  box-shadow: 0 0 0 2px #007aff22;
}
input[type="text"]::placeholder, input[type="number"]::placeholder {
  color: #bdbdc2;
  opacity: 1;
}
.modal-content {
  background: var(--panel-bg);
  border-radius: 24px;
  box-shadow: 0 12px 48px #0002;
  padding: 36px 32px 28px 32px;
  min-width: 320px;
  max-width: 96vw;
  /* animation: fadeIn 0.5s; */
  animation: none !important;
}
.icon {
  color: var(--text);
  stroke-width: 2;
  width: 1.25em;
  height: 1.25em;
  fill: none;
  vertical-align: middle;
  transition: color 0.18s, stroke 0.18s;
}
::-webkit-scrollbar {
  width: 8px;
  background: #f2f2f7;
  border-radius: 8px;
}
::-webkit-scrollbar-thumb {
  background: #e5e5ea;
  border-radius: 8px;
}
#monster-details {
  overflow: auto;
  max-height: 100%;
}
#monster-search-list {
  overflow: auto;
  max-height: 100%;
}
.hp-value, .type-value, .init-value, .ac-value, .insp-value, .temp-value {
  cursor: pointer;
  border-radius: 8px;
  padding: 3px 10px;
  transition: background 0.15s;
  color: var(--text);
  font-weight: 500;
}
.hp-value:hover, .type-value:hover, .init-value:hover, .ac-value:hover, .insp-value:hover, .temp-value:hover {
  background: #e5e5ea;
}

body.dark-theme {
  --main-bg: #161618;
  --panel-bg: #23232b;
  --accent: #fff;
  --border: #23232b;
  --text: #f2f2f7;
  --text-light: #b0b0b8;
  --shadow: 0 4px 24px #0008;
  background: #161618;
  color: var(--text);
}
body.dark-theme .table-wrapper {
  background: var(--panel-bg);
  box-shadow: var(--shadow);
}
body.dark-theme th {
  background: #23232b;
  color: var(--text-light);
}
body.dark-theme td, body.dark-theme th {
  border-right: 1px solid #23232b;
}
body.dark-theme tbody tr {
  border-bottom: 1px solid #23232b;
}
body.dark-theme tbody tr:nth-child(even) {
  background: #23232b;
}
body.dark-theme tbody tr:hover {
  background: #292933;
}
body.dark-theme tbody tr[style*="background:#3a4252"] {
  background: #2d3750 !important;
  color: #fff;
}
body.dark-theme .hp-value,
body.dark-theme .type-value,
body.dark-theme .init-value,
body.dark-theme .ac-value,
body.dark-theme .insp-value,
body.dark-theme .temp-value {
  color: #f2f2f7;
}
body.dark-theme .hp-value:hover,
body.dark-theme .type-value:hover,
body.dark-theme .init-value:hover,
body.dark-theme .ac-value:hover,
body.dark-theme .insp-value:hover,
body.dark-theme .temp-value:hover {
  background: #23232b;
}
body.dark-theme button, body.dark-theme .table-wrapper button {
  background: linear-gradient(90deg, #23232b 60%, #292933 100%);
  color: #f2f2f7;
  border: 1.5px solid #23232b;
}
body.dark-theme button:hover, body.dark-theme .table-wrapper button:hover {
  background: linear-gradient(90deg, #292933 60%, #23232b 100%);
  color: #fff;
  box-shadow: 0 4px 16px #0008;
  border-color: #444857;
}
body.dark-theme button:active, body.dark-theme .table-wrapper button:active {
  background: #161618;
  color: #fff;
  transform: scale(0.97);
  box-shadow: 0 1px 4px #0008;
}
body.dark-theme input[type="text"],
body.dark-theme input[type="number"],
body.dark-theme select {
  background: #23232b;
  border: 1.5px solid #23232b;
  color: #f2f2f7;
}
body.dark-theme input[type="text"]:focus,
body.dark-theme input[type="number"]:focus,
body.dark-theme select:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px #0a84ff33;
}
body.dark-theme input[type="text"]::placeholder,
body.dark-theme input[type="number"]::placeholder {
  color: #666;
  opacity: 1;
}
body.dark-theme .modal-content {
  background: var(--panel-bg);
  color: var(--text);
  box-shadow: 0 12px 48px #0008;
}
body.dark-theme .icon {
  color: #f2f2f7;
  stroke: #f2f2f7;
}
body.dark-theme ::-webkit-scrollbar {
  background: #23232b;
}
body.dark-theme ::-webkit-scrollbar-thumb {
  background: #292933;
}
body.dark-theme .modal-content,
body.dark-theme [style*="background:#fff;"][style*="box-shadow:0 8px 32px"],
body.dark-theme [style*="background:#fff;"][style*="box-shadow:0 12px 48px"],
body.dark-theme [style*="background:#fff;"][style*="border-radius:18px"],
body.dark-theme [style*="background:#fff;"][style*="border-radius:24px"] {
  background: var(--panel-bg) !important;
  color: var(--text) !important;
  box-shadow: 0 12px 48px #0008 !important;
}
body.dark-theme #monster-details,
body.dark-theme #monster-search-list,
body.dark-theme #ref-tab-content {
  background: transparent !important;
  color: var(--text) !important;
}
body.dark-theme .ref-list-item {
  background: transparent;
  color: var(--text);
}
body.dark-theme .ref-list-item:hover {
  background: #23272f;
}
body.dark-theme h2, body.dark-theme h3 {
  color: var(--text);
}
body.dark-theme img {
  box-shadow: 0 2px 12px #0004;
}

/* --- Sticky header for table --- */
thead th {
  position: sticky;
  top: 0;
  z-index: 2;
  background: var(--panel-bg);
  box-shadow: 0 2px 8px #0001;
}
body.dark-theme thead th {
  background: #23272f;
  box-shadow: 0 2px 8px #0008;
}

/* --- Fade-in animation for modals and table rows --- */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(16px); }
  to { opacity: 1; transform: none; }
}
.fade-in, .modal-content, tbody tr {
  /* animation: fadeIn 0.5s cubic-bezier(.4,0,.2,1); */
  animation: none !important;
}

/* --- Fade-out animation for modals and table rows --- */
@keyframes fadeOut {
  from { opacity: 1; transform: none; }
  to { opacity: 0; transform: translateY(16px); }
}
.fade-out {
  animation: fadeOut 0.45s cubic-bezier(.4,0,.2,1) forwards;
}

/* --- Card-like look for modals and table wrapper --- */
.table-wrapper, .modal-content {
  box-shadow: 0 8px 32px #0002;
  border-radius: var(--radius);
}
body.dark-theme .table-wrapper, body.dark-theme .modal-content {
  box-shadow: 0 12px 48px #0008;
}

/* --- Tooltip styles --- */
.tooltip {
  position: relative;
  cursor: pointer;
}
.tooltip::after {
  content: attr(data-tooltip);
  position: absolute;
  left: 50%;
  bottom: 120%;
  transform: translateX(-50%) scale(0.95);
  background: #23272f;
  color: #fff;
  padding: 9px 16px;
  border-radius: 10px;
  font-size: 1.05em;
  white-space: pre-line;
  box-shadow: 0 2px 12px #0003;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.18s, transform 0.18s;
  z-index: 100;
  min-width: 80px;
  max-width: 320px;
  text-align: center;
  line-height: 1.3;
}
.tooltip:hover::after, .tooltip:focus::after {
  opacity: 1;
  transform: translateX(-50%) scale(1);
}
body.dark-theme .tooltip::after {
  background: #111216;
  color: #f3f3f7;
  box-shadow: 0 2px 12px #0008;
}

/* Акцентные кнопки */
.accent-btn {
  background: linear-gradient(90deg, #007aff 60%, #4f8cff 100%);
  color: #fff !important;
  border: none;
  box-shadow: 0 2px 12px #007aff22;
}
.accent-btn:hover {
  background: linear-gradient(90deg, #005be7 60%, #007aff 100%);
  color: #fff !important;
}

/* Активная строка */
.active-row {
  background: #e0e7ff !important;
  font-weight: 700;
  box-shadow: 0 2px 12px #007aff11;
}
body.dark-theme .active-row {
  background: #2d3750 !important;
  color: #fff;
}

/* Минималистичные иконки */
.icon, svg.icon {
  vertical-align: middle;
  stroke-width: 2;
  width: 1.25em;
  height: 1.25em;
  color: #23272f;
  fill: none;
  transition: color 0.18s, stroke 0.18s;
}
body.dark-theme .icon, body.dark-theme svg.icon {
  color: #f3f3f7;
}

/* Круглые кнопки с иконками */
.icon-btn {
  border-radius: 50%;
  padding: 8px;
  width: 38px;
  height: 38px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: #f6f7f9;
  border: 1.5px solid #e5e5ea;
  box-shadow: 0 1.5px 6px #0001;
  transition: background 0.18s, border 0.18s, box-shadow 0.18s;
}
.icon-btn:hover {
  background: #e5e5ea;
  border-color: #bfc0c5;
}
body.dark-theme .icon-btn {
  background: #23272f;
  border: 1.5px solid #2c2f36;
}
body.dark-theme .icon-btn:hover {
  background: #2c2f36;
  border-color: #444857;
}

/* Tooltip чуть крупнее */
.tooltip::after {
  font-size: 1.05em;
  padding: 9px 16px;
}

/* Ещё больше воздуха и скруглений */
.table-wrapper, .modal-content {
  border-radius: 22px;
  padding-bottom: 18px;
}
thead th, tbody td {
  border-radius: 0;
}

/* Плавные переходы для строк */
tbody tr, tbody td {
  transition: background 0.18s, color 0.18s, box-shadow 0.18s;
}

/* Анимация броска кубика */
.dice-btn.dice-rolling .dice-svg {
  /* animation: diceShake 0.7s cubic-bezier(.4,0,.2,1), diceFlash 0.4s cubic-bezier(.4,0,.2,1); */
  animation: none !important;
}
@keyframes diceShake {
  0% { transform: rotate(0deg) scale(1); }
  20% { transform: rotate(-18deg) scale(1.1); }
  40% { transform: rotate(14deg) scale(1.08); }
  60% { transform: rotate(-10deg) scale(1.12); }
  80% { transform: rotate(8deg) scale(1.05); }
  100% { transform: rotate(0deg) scale(1); }
}
@keyframes diceFlash {
  0% { filter: drop-shadow(0 0 0 #fff); }
  40% { filter: drop-shadow(0 0 12px #fff8); }
  100% { filter: drop-shadow(0 0 0 #fff); }
}
/* SVG-иконки дайсов — крупнее и ярче */
.dice-svg {
  width: 28px;
  height: 28px;
  stroke: #007aff;
  fill: #e3f2fd;
  display: inline-block;
  vertical-align: middle;
  margin-right: 0;
  transition: stroke 0.18s, filter 0.18s;
}
body.dark-theme .dice-svg {
  stroke: #4f8cff;
  fill: #23272f;
}
#dice-panel {
  background: var(--panel-bg);
  border-radius: 14px;
  box-shadow: 0 2px 12px #0001;
  padding: 14px 18px 10px 18px;
  margin-bottom: 18px;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
}
#dice-history {
  color: #007aff;
  font-family: var(--font);
  font-size: 1.08em;
  margin-top: 8px;
}
body.dark-theme #dice-history {
  color: #4f8cff;
}

/* Стили для массовых операций */
.mass-btn {
  padding: 6px 12px;
  border: 1px solid #dee2e6;
  border-radius: 6px;
  background: #fff;
  color: #495057;
  font-size: 0.9em;
  cursor: pointer;
  transition: all 0.2s ease;
  font-weight: 500;
}

.mass-btn:hover {
  background: #f8f9fa;
  border-color: #adb5bd;
  transform: translateY(-1px);
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.mass-btn.damage-btn:hover {
  background: #fff5f5;
  border-color: #e53e3e;
  color: #c53030;
}

.mass-btn.heal-btn:hover {
  background: #f0fff4;
  border-color: #38a169;
  color: #2f855a;
}

.mass-btn.effect-btn:hover {
  background: #faf5ff;
  border-color: #805ad5;
  color: #553c9a;
}

.mass-btn.insp-btn:hover {
  background: #fffbeb;
  border-color: #d69e2e;
  color: #b7791f;
}

.mass-btn.ac-btn:hover {
  background: #f7fafc;
  border-color: #3182ce;
  color: #2c5282;
}

.mass-btn.init-btn:hover {
  background: #f0fff4;
  border-color: #38a169;
  color: #2f855a;
}

.mass-btn.temphp-btn:hover {
  background: #fffaf0;
  border-color: #dd6b20;
  color: #c05621;
}

.mass-btn.spell-btn:hover {
  background: #faf5ff;
  border-color: #805ad5;
  color: #553c9a;
}

.mass-btn.inv-btn:hover {
  background: #f0fff4;
  border-color: #38a169;
  color: #2f855a;
}

.mass-btn.delete-btn:hover {
  background: #fff5f5;
  border-color: #e53e3e;
  color: #c53030;
}

.mass-btn.clear-btn:hover {
  background: #f7fafc;
  border-color: #718096;
  color: #4a5568;
}

/* Темная тема для массовых кнопок */
body.dark-theme .mass-btn {
  background: #2c2f36;
  border-color: #4a5568;
  color: #e2e8f0;
}

body.dark-theme .mass-btn:hover {
  background: #374151;
  border-color: #6b7280;
  color: #f3f4f6;
}

body.dark-theme .mass-btn.damage-btn:hover {
  background: #7f1d1d;
  border-color: #dc2626;
  color: #fecaca;
}

body.dark-theme .mass-btn.heal-btn:hover {
  background: #14532d;
  border-color: #16a34a;
  color: #bbf7d0;
}

body.dark-theme .mass-btn.effect-btn:hover {
  background: #581c87;
  border-color: #9333ea;
  color: #d8b4fe;
}

body.dark-theme .mass-btn.insp-btn:hover {
  background: #78350f;
  border-color: #eab308;
  color: #fef3c7;
}

body.dark-theme .mass-btn.ac-btn:hover {
  background: #1e3a8a;
  border-color: #3b82f6;
  color: #bfdbfe;
}

body.dark-theme .mass-btn.init-btn:hover {
  background: #14532d;
  border-color: #16a34a;
  color: #bbf7d0;
}

body.dark-theme .mass-btn.temphp-btn:hover {
  background: #7c2d12;
  border-color: #ea580c;
  color: #fed7aa;
}

body.dark-theme .mass-btn.spell-btn:hover {
  background: #581c87;
  border-color: #9333ea;
  color: #d8b4fe;
}

body.dark-theme .mass-btn.inv-btn:hover {
  background: #14532d;
  border-color: #16a34a;
  color: #bbf7d0;
}

body.dark-theme .mass-btn.delete-btn:hover {
  background: #7f1d1d;
  border-color: #dc2626;
  color: #fecaca;
}

body.dark-theme .mass-btn.clear-btn:hover {
  background: #374151;
  border-color: #6b7280;
  color: #f3f4f6;
} 

/* --- Навигационная панель в стиле Apple --- */
.main-nav {
  position: sticky;
  top: 0;
  z-index: 10;
  background: var(--panel-bg);
  padding: 12px 0 8px 0;
  box-shadow: 0 4px 32px #0001, 0 1.5px 6px #0001;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  align-items: center;
  border-radius: 0 0 18px 18px;
  min-height: 48px;
  transition: background 0.35s, box-shadow 0.35s, border-radius 0.35s;
}

.nav-btn {
  font-size: 1em;
  padding: 7px 18px;
  border-radius: 10px;
  box-shadow: 0 1px 4px #0001;
  background: #f7f7fa;
  color: #23232b;
  border: none;
  font-weight: 600;
  transition: background 0.18s, color 0.18s, box-shadow 0.18s, transform 0.13s cubic-bezier(.4,0,.2,1);
  margin: 0 1px;
}
.nav-btn:hover {
  background: #ececec;
  color: #111;
  box-shadow: 0 6px 24px #0002;
  transform: scale(1.04);
}
body.dark-theme .nav-btn {
  background: #292933;
  color: #f7f7fa;
}
body.dark-theme .nav-btn:hover {
  background: #353545;
  color: #fff;
}
.nav-btn svg {
  display: inline-block;
  vertical-align: middle;
  color: var(--accent);
  width: 1.2em;
  height: 1.2em;
  transition: color 0.18s;
}
.nav-btn span {
  display: inline-block;
  vertical-align: middle;
  font-size: 1em;
}
.nav-btn:hover, .nav-btn:focus {
  background: linear-gradient(90deg, #e5e5ea 60%, #f8f8fa 100%);
  color: var(--accent);
  box-shadow: 0 4px 16px #0001;
  border-color: #bfc0c5;
}
.nav-btn:active {
  background: #e5e5ea;
  color: var(--accent);
  transform: scale(0.97);
  box-shadow: 0 1px 4px #0001;
}
.nav-btn.accent {
  background: linear-gradient(90deg, #007aff 60%, #4f8cff 100%);
  color: #fff;
}
.nav-btn.accent svg {
  color: #fff;
}
.nav-btn.accent:hover, .nav-btn.accent:focus {
  background: linear-gradient(90deg, #005be7 60%, #007aff 100%);
  color: #fff;
}
.nav-group {
  display: flex;
  gap: 6px;
  align-items: center;
  background: none;
  border-radius: 10px;
  padding: 0 2px;
}
.nav-select {
  padding: 8px 14px;
  border-radius: 10px;
  font-size: 1em;
  font-family: var(--font);
  border: 1.5px solid var(--border);
  background: #f8f8fa;
  color: var(--text);
  margin-left: 6px;
  transition: border 0.18s, box-shadow 0.18s;
  outline: none;
}
.nav-select:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px #007aff22;
}
@media (max-width: 900px) {
  .main-nav {
    gap: 6px;
    padding: 8px 0 4px 0;
  }
  .nav-btn {
    padding: 7px 10px;
    font-size: 0.97em;
  }
  .nav-group {
    gap: 3px;
  }
  .nav-select {
    padding: 7px 8px;
    font-size: 0.97em;
  }
}
@media (max-width: 600px) {
  .main-nav {
    flex-direction: column;
    align-items: stretch;
    gap: 4px;
    border-radius: 0 0 12px 12px;
  }
  .nav-btn, .nav-select {
    width: 100%;
    min-width: 0;
    justify-content: flex-start;
  }
  .nav-group {
    flex-direction: column;
    gap: 2px;
    padding: 0;
  }
} 

/* --- Элегантный контейнер для навигации --- */
.nav-wrapper {
  width: 100%;
  max-width: 100vw;
  margin: 0 auto 18px auto;
  border-radius: 22px;
  box-shadow: 0 8px 32px #0002, 0 1.5px 6px #0001;
  background: rgba(255,255,255,0.82);
  backdrop-filter: blur(12px);
  transition: box-shadow 0.25s, background 0.25s;
  /* animation: navFadeIn 0.9s cubic-bezier(.4,0,.2,1); */
  animation: none !important;
}
@media (max-width: 600px) {
  .nav-wrapper {
    border-radius: 14px;
    margin-bottom: 10px;
  }
}
@keyframes navFadeIn {
  from { opacity: 0; transform: translateY(-28px) scale(0.98); filter: blur(6px); }
  to { opacity: 1; transform: none; filter: none; }
}
body.dark-theme .nav-wrapper {
  background: rgba(35,35,43,0.92);
  box-shadow: 0 12px 48px #0008, 0 1.5px 6px #0002;
} 

/* --- Отключаем анимацию появления строк таблицы --- */
tbody tr {
  /* animation: fadeIn 0.5s cubic-bezier(.4,0,.2,1); */
  animation: none !important;
}

/* --- Крутая анимация кнопок --- */
.nav-btn, .table-wrapper button, button {
  transition: background 0.18s, color 0.18s, box-shadow 0.18s, border 0.18s, transform 0.13s cubic-bezier(.4,0,.2,1), filter 0.18s;
}
.nav-btn:hover, .table-wrapper button:hover, button:hover {
  transform: scale(1.045);
  box-shadow: 0 6px 24px #007aff22, 0 1.5px 6px #0001;
  filter: brightness(1.04) saturate(1.08);
}
.nav-btn:active, .table-wrapper button:active, button:active {
  transform: scale(0.97);
  box-shadow: 0 1px 4px #0002;
  filter: brightness(0.98);
}

/* --- Микроанимация SVG-иконок на hover --- */
.nav-btn svg {
  transition: color 0.18s, transform 0.22s cubic-bezier(.4,0,.2,1);
}
.nav-btn:hover svg, .nav-btn:focus svg {
  transform: scale(1.18) rotate(-8deg);
  color: var(--accent);
}
.nav-btn.accent:hover svg, .nav-btn.accent:focus svg {
  color: #fff;
  transform: scale(1.18) rotate(8deg);
}

/* --- Плавная смена темы --- */
body, .nav-wrapper, .main-nav, .nav-btn, .table-wrapper, .modal-content {
  transition: background 0.35s cubic-bezier(.4,0,.2,1), color 0.35s, box-shadow 0.35s, border 0.35s, filter 0.35s;
} 

/* --- Ресайзер для столбцов таблицы --- */
.resizer {
  position: absolute;
  top: 0;
  right: -4px;
  width: 8px;
  height: 100%;
  cursor: col-resize;
  z-index: 2;
  background: transparent;
  transition: background 0.18s;
  border-radius: 4px;
}
.resizer:hover {
  background: rgba(0,0,0,0.08);
}
.th-label {
  user-select: none;
  pointer-events: none;
} 

/* --- Кастомные чекбоксы --- */
input[type="checkbox"] {
  appearance: none;
  -webkit-appearance: none;
  width: 22px;
  height: 22px;
  border: 2px solid var(--border);
  border-radius: 7px;
  background: var(--panel-bg);
  transition: border 0.18s, box-shadow 0.18s, background 0.18s;
  cursor: pointer;
  position: relative;
  outline: none;
  box-shadow: 0 1.5px 6px #0001;
  display: inline-block;
  vertical-align: middle;
}
input[type="checkbox"]:hover {
  border-color: var(--accent);
  box-shadow: 0 2px 8px #0002;
}
input[type="checkbox"]:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px var(--accent)33;
}
input[type="checkbox"]:checked {
  background: var(--accent);
  border-color: var(--accent);
}
input[type="checkbox"]::before {
  content: '';
  display: block;
  position: absolute;
  left: 5px;
  top: 2px;
  width: 6px;
  height: 12px;
  border-right: 3px solid #fff;
  border-bottom: 3px solid #fff;
  border-radius: 1.5px;
  opacity: 0;
  transform: scale(0.7) rotate(20deg);
  transition: opacity 0.18s, transform 0.18s;
}
input[type="checkbox"]:checked::before {
  opacity: 1;
  transform: scale(1) rotate(45deg);
}
body.dark-theme input[type="checkbox"] {
  background: var(--panel-bg);
  border-color: #444;
}
body.dark-theme input[type="checkbox"]:checked {
  background: var(--accent);
  border-color: var(--accent);
}
body.dark-theme input[type="checkbox"]::before {
  border-right: 3px solid #111;
  border-bottom: 3px solid #111;
} 

/* --- Центрирование чекбоксов в таблице --- */
th input[type="checkbox"], td input[type="checkbox"] {
  display: block;
  margin: 0 auto;
}
.checkbox-center {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
} 

/* --- Минималистичное инлайн-редактирование --- */
.inline-edit {
  border: none;
  outline: none;
  background: transparent;
  border-bottom: 2px solid var(--accent);
  font-size: 1em;
  font-family: var(--font);
  color: var(--text);
  width: 100%;
  padding: 2px 2px 2px 0;
  margin: 0;
  box-sizing: border-box;
  transition: border-color 0.18s, background 0.18s;
}
.inline-edit:focus {
  background: rgba(0,0,0,0.03);
  border-bottom: 2.5px solid var(--accent);
}
.inline-edit[type='number']::-webkit-inner-spin-button,
.inline-edit[type='number']::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
.inline-edit[type='number'] {
  -moz-appearance: textfield;
} 

/* --- Отключаем анимации и transitions для таблицы --- */
thead, tbody, tbody tr {
  animation: none !important;
  transition: none !important;
} 

/* --- Полное отключение анимации и переходов для шапки таблицы --- */
thead, thead *, th {
  animation: none !important;
  transition: none !important;
  filter: none !important;
  opacity: 1 !important;
} 

@keyframes inlineFadeIn {
  from { opacity: 0; transform: scale(0.97) translateY(8px); }
  to { opacity: 1; transform: none; }
}
@keyframes inlineFadeOut {
  from { opacity: 1; transform: none; }
  to { opacity: 0; transform: scale(0.97) translateY(8px); }
}
.inline-edit {
  animation: inlineFadeIn 0.22s cubic-bezier(.4,0,.2,1);
  transition: border-color 0.18s, background 0.18s;
}
.inline-edit.removing {
  animation: inlineFadeOut 0.18s cubic-bezier(.4,0,.2,1) forwards;
} 

/* --- Карточки инвентаря и эффектов --- */
.chip, .effect-chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  background: #f7f7fa;
  color: #23232b;
  border-radius: 12px;
  padding: 4px 12px;
  margin: 2px 2px 2px 0;
  box-shadow: 0 2px 8px #0001;
  font-size: 0.98em;
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  vertical-align: middle;
  transition: background 0.18s, color 0.18s, box-shadow 0.18s;
}
.effect-chip {
  background: #b0bec5 !important;
  color: #23232b !important;
  font-size: 0.97em;
  box-shadow: 0 2px 8px #0002;
}
.chip button, .effect-chip button {
  background: #ececec;
  color: #c00;
  border: none;
  border-radius: 8px;
  padding: 2px 8px;
  margin-left: 2px;
  cursor: pointer;
  font-size: 1em;
  transition: background 0.18s, color 0.18s;
  box-shadow: 0 1px 4px #0001;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}
.chip button:hover, .effect-chip button:hover {
  background: #ffd6d6;
  color: #a00;
}

body.dark-theme .chip, body.dark-theme .effect-chip {
  background: #292933 !important;
  color: #f2f2f7 !important;
  box-shadow: 0 2px 8px #0008;
}
body.dark-theme .effect-chip {
  background: #353545 !important;
  color: #fff !important;
}
body.dark-theme .chip button, body.dark-theme .effect-chip button {
  background: #353545;
  color: #ff7979;
  box-shadow: 0 1px 4px #0008;
}
body.dark-theme .chip button:hover, body.dark-theme .effect-chip button:hover {
  background: #7f1d1d;
  color: #fff;
} 

.inspiration-btn {
  background: none;
  border: none;
  cursor: pointer;
  font-size: 1.25em;
  line-height: 1;
  color: #b0b0b8;
  transition: color 0.18s, transform 0.18s;
  padding: 0 2px;
}
.inspiration-btn.active {
  color: var(--accent);
  transform: scale(1.18) rotate(-8deg);
  text-shadow: 0 2px 8px #ffd70055;
}
.inspiration-btn:hover {
  color: #ffb300;
  transform: scale(1.12);
} 

.spellslots-btn {
  background: none;
  border: none;
  cursor: pointer;
  font-size: 1.18em;
  line-height: 1;
  color: #7c4dff;
  transition: color 0.18s, transform 0.18s;
  padding: 0 2px;
}
.spellslots-btn:hover {
  color: #4f8cff;
  transform: scale(1.13) rotate(-6deg);
}
.spellslots-summary span {
  margin-right: 4px;
  background: #f2f2f7;
  border-radius: 6px;
  padding: 1px 6px;
  color: #555;
  font-size: 0.97em;
  display: inline-block;
} 

/* Кнопка очистки истории дайсов */
.clear-dice-btn {
  padding: 7px 18px;
  border-radius: 8px;
  border: 1.5px solid #ffd0d0;
  background: #fff0f0;
  color: #e53935;
  font-size: 1em;
  font-family: var(--font);
  font-weight: 500;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  transition: background 0.18s, border 0.18s, color 0.18s, box-shadow 0.18s;
  box-shadow: 0 1.5px 6px #0001;
  margin-left: 8px;
}
.clear-dice-btn:hover, .clear-dice-btn:focus {
  background: #ffeaea;
  border-color: #ffb3b3;
  color: #b71c1c;
  box-shadow: 0 4px 16px #ffd0d044;
}
body.dark-theme .clear-dice-btn {
  background: #2c1a1a;
  border-color: #a94442;
  color: #ffb3b3;
}
body.dark-theme .clear-dice-btn:hover, body.dark-theme .clear-dice-btn:focus {
  background: #3a2323;
  border-color: #ffb3b3;
  color: #ff7979;
} 

/* Анимация броска дайса (shake) */
.dice-svg.dice-rolling {
  animation: diceShake 0.5s cubic-bezier(.4,0,.2,1);
}
@keyframes diceShake {
  0% { transform: rotate(0deg) scale(1); }
  20% { transform: rotate(-18deg) scale(1.1); }
  40% { transform: rotate(14deg) scale(1.08); }
  60% { transform: rotate(-10deg) scale(1.12); }
  80% { transform: rotate(8deg) scale(1.05); }
  100% { transform: rotate(0deg) scale(1); }
}

/* Анимация появления значения в истории (fade-in + scale) */
.dice-history-item {
  animation: fadeInScale 0.5s cubic-bezier(.4,0,.2,1);
}
@keyframes fadeInScale {
  0% { opacity: 0; transform: scale(0.7); }
  60% { opacity: 1; transform: scale(1.08); }
  100% { opacity: 1; transform: scale(1); }
} 

body.dark-theme .main-content {
  background: #161618 !important;
  transition: background 0.35s;
}
body.dark-theme .main-nav {
  background: #23232b !important;
  box-shadow: 0 2px 8px #0008 !important;
  transition: background 0.35s, box-shadow 0.35s;
} 

body.dark-theme .minimal-table {
  background: #23232b;
  color: #f2f2f7;
}
body.dark-theme .minimal-table th {
  background: #292933;
  color: #b0b0b8;
}
body.dark-theme .minimal-table td {
  background: #23232b;
  color: #f2f2f7;
}
body.dark-theme .minimal-table tr:nth-child(even) {
  background: #292933;
}
body.dark-theme .minimal-table tr:hover {
  background: #353545;
}
body.dark-theme tr.active-turn {
  background: #2d3750 !important;
  color: #fff;
  box-shadow: 0 2px 12px #007aff44;
  border-left: 4px solid #4f8cff;
}
body.dark-theme .nav-btn,
body.dark-theme .table-wrapper button,
body.dark-theme button {
  background: #292933;
  color: #f2f2f7;
  border: 1px solid #353545;
}
body.dark-theme .nav-btn:hover,
body.dark-theme .table-wrapper button:hover,
body.dark-theme button:hover {
  background: #353545;
  color: #fff;
} 

/* --- DARK THEME: Ячейка хитов --- */
body.dark-theme .cell-hp {
  background: #2d3750 !important;
  color: #fff !important;
}
body.dark-theme .cell-hp[style*="background:#e0e7ff"] {
  background: #2d3750 !important;
  color: #fff !important;
}

/* --- DARK THEME: Модальные окна и справочник --- */
body.dark-theme .modal-content,
body.dark-theme #monster-modal .modal-content,
body.dark-theme #reference-modal .modal-content {
  background: #23232b !important;
  color: #f2f2f7 !important;
  box-shadow: 0 12px 48px #0008 !important;
}
body.dark-theme .monster-list-item {
  background: #23232b !important;
  color: #f2f2f7 !important;
}
body.dark-theme .monster-list-item[style*="background:#e5f0ff"] {
  background: #2d3750 !important;
  color: #fff !important;
}
body.dark-theme .monster-list-item:hover {
  background: #353545 !important;
  color: #fff !important;
} 